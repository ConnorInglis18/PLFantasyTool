(this["webpackJsonpdads-spreadsheet"]=this["webpackJsonpdads-spreadsheet"]||[]).push([[0],{33:function(e,t,a){e.exports=a(44)},38:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(15),l=a.n(o),s=(a(38),a(8)),i=a(9),c=a(11),u=a(10),m=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.weekArray;return 1===e.length?r.a.createElement("td",{style:Object.assign({},{background:e[0].color},p.tableData)},e[0].value):0===e.length?r.a.createElement("td",{style:Object.assign({},p.darkgrey,p.tableData)}):r.a.createElement("td",{style:p.doubleGame},r.a.createElement("div",{style:Object.assign({},{background:e[0].color},p.doubleGameData)},e[0].value),r.a.createElement("div",{style:Object.assign({},{background:e[1].color},p.doubleGameData)},e[1].value))}}]),a}(n.Component),p={tableData:{height:"4vh",width:"2.2vw",textAlign:"center",border:"1px solid black",fontSize:"1vw"},doubleGame:{border:"1px solid black",width:"2.2vw"},doubleGameData:{height:"2vh",fontSize:".75vw",display:"flex",alignItems:"center",justifyContent:"center"},darkgrey:{background:"darkgrey",color:"darkgrey"}},d=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).createTable=function(t){return Object.keys(t).map((function(a){return a=t[a],r.a.createElement("tr",{key:a.short_name},r.a.createElement("td",{style:Object.assign({},{background:a.goals.color},h.tableData)},a.goals.value),r.a.createElement("th",null,a.short_name),a.upcoming_fixtures.map((function(t,n){return r.a.createElement(m,{weekArray:t,key:"".concat(a.short_name,"-").concat(n,"-").concat(e.props.type)})})))}))},e.createHeaders=function(e,t){var a=[];"DEFENDERS"===e?a.push("GA"):a.push("GF"),a.push("Team");for(var n=t;n<39;++n)n<10?a.push("0"+n):a.push(n);var o=a.map((function(e){return r.a.createElement("th",{key:e,style:h.column},e)}));return r.a.createElement("tr",null,o)},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{style:h.background},r.a.createElement("table",null,r.a.createElement("tbody",null,this.createHeaders(this.props.type,this.props.upcomingGameweek),this.createTable(this.props.display))))}}]),a}(n.Component),h={background:{padding:"2vh 2vw",display:"flex",flexFlow:"column no-wrap",alignItems:"stretch",background:"lightgrey",overflowX:"auto"},column:{textAlign:"center"},tableData:{height:"4vh",width:"2.2vw",textAlign:"center",border:"1px solid black",fontSize:"1vw"},doubleGame:{border:"1px solid black",width:"2.2vw"},doubleGameData:{height:"2vh",fontSize:".75vw",display:"flex",alignItems:"center",justifyContent:"center"},darkgrey:{background:"darkgrey",color:"darkgrey"}},g=a(22),f=a(64),v=a(66),y=a(68),b=a(67),E=a(72),k=Object(f.a)((function(e){return{home:{position:"relative",backgroundColor:e.palette.grey[800],color:e.palette.common.white,marginBottom:e.spacing(4),backgroundImage:"url(https://source.unsplash.com/random)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},overlay:{position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"rgba(0,0,0,.3)"},homeContent:Object(g.a)({position:"relative",padding:e.spacing(3)},e.breakpoints.up("md"),{padding:e.spacing(6),paddingRight:0})}}));function w(e){var t=k(),a=e.post,n=e.refreshData;return r.a.createElement(v.a,{className:t.home,style:{backgroundImage:"url(".concat(a.image,")")}},r.a.createElement("img",{style:{display:"none"},src:a.image,alt:a.imageText}),r.a.createElement("div",{className:t.overlay}),r.a.createElement(b.a,{container:!0},r.a.createElement(b.a,{item:!0,md:6},r.a.createElement("div",{className:t.homeContent},r.a.createElement(y.a,{component:"h1",variant:"h3",color:"inherit",gutterBottom:!0},a.title),r.a.createElement(y.a,{variant:"h5",color:"inherit",paragraph:!0},a.description),r.a.createElement(E.a,{variant:"subtitle1",href:"#"},a.linkText)),r.a.createElement("div",{className:t.homeContent},r.a.createElement("button",{onClick:n},"Refresh Data")))))}var T=a(69),_=Object(f.a)((function(e){return{toolbar:{borderBottom:"1px solid ".concat(e.palette.divider)},toolbarTitle:{flex:1},toolbarSecondary:{justifyContent:"space-between",overflowX:"auto"},toolbarLink:{padding:e.spacing(1),flexShrink:0}}}));function D(e){var t=_(),a=e.sections;return r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{component:"nav",variant:"dense",className:t.toolbarSecondary},a.map((function(e){return r.a.createElement(E.a,{title:e.title,color:"inherit",noWrap:!0,key:e.title,variant:"body2",href:"#",className:t.toolbarLink,onClick:e.onClick},e.title)}))))}var S="https://pl-fantasy-tool-cors.herokuapp.com/https://fantasy.premierleague.com/api/bootstrap-static/",x="https://pl-fantasy-tool-cors.herokuapp.com/https://fantasy.premierleague.com/api/fixtures/",A=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).addPlayerToUserTeam=function(e){e.preventDefault();var t=n.state.userTeams,a=t[n.state.currentTeamIndex];-1===a.players.indexOf(e.target.id)&&a.players.push(e.target.id),t[n.state.currentTeamIndex]=a,n.setState({userTeams:t}),localStorage.setItem("TEAM_DATA",JSON.stringify(t))},n.removePlayerFromUserTeam=function(e){e.preventDefault();var t=n.state.userTeams,a=t[n.state.currentTeamIndex],r=a.players.indexOf(e.target.id);-1!==r&&a.players.splice(r,1),t[n.state.currentTeamIndex]=a,n.setState({userTeams:t}),localStorage.setItem("TEAM_DATA",JSON.stringify(t))},n.handleTeamNameChange=function(e){n.setState({teamName:e.target.value})},n.handleTeamNameSubmit=function(e){e.preventDefault();var t=n.state.userTeams,a={name:n.state.teamName,players:[]};console.log(a),t.push(a),n.setState({userTeams:t,teamName:""}),localStorage.setItem("TEAM_DATA",JSON.stringify(t))},n.changeCurrentTeam=function(e){n.setState({currentTeamIndex:e})},n.state={userTeams:[],currentTeamIndex:0,teamName:""},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("TEAM_DATA");null!==e&&(e=JSON.parse(e),this.setState({userTeams:e}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.players,n=t.defendersDisplay,o=t.attackersDisplay,l=Object.values(a).sort((function(e,t){return e.element_type-t.element_type||t.total_points-e.total_points})),s=[[],[],[],[]];if(this.state.userTeams.length&&n.length){var i=this.state.userTeams[this.state.currentTeamIndex];console.log(i),i.players.forEach((function(e){var t={};t.player_id=e,t.web_name=a[e].web_name;var r=a[e].team_id;t.team_id=r,t.total_points=a[e].total_points,t.now_cost=a[e].now_cost,console.log(a[e]);var l=a[e].element_type;t.upcoming_fixtures=l<=2?n[r-1].upcoming_fixtures:o[r-1].upcoming_fixtures,s[l-1].push(t)}))}var c=["GOALKEEPERS","DEFENDERS","MIDFIELDERS","FORWARDS"];return r.a.createElement("div",null,0===this.state.userTeams.length?r.a.createElement("div",null,"Create a team",r.a.createElement("form",{onSubmit:this.handleTeamNameSubmit},r.a.createElement("label",null,"Team name:",r.a.createElement("input",{type:"text",name:"teamName",value:this.state.teamName,onChange:this.handleTeamNameChange})),r.a.createElement("input",{type:"submit",value:"Submit"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:O.teamInfo},r.a.createElement("div",null,"Teams:",this.state.userTeams.map((function(t,a){return a===e.state.currentTeamIndex?r.a.createElement("button",{key:"navbar-"+t.name,style:Object.assign({},O.teamButton,O.selectedTeam),onClick:function(){return e.changeCurrentTeam(a)}},t.name):r.a.createElement("button",{key:"navbar-"+t.name,style:O.teamButton,onClick:function(){return e.changeCurrentTeam(a)}},t.name)}))),r.a.createElement("form",{style:O.newTeamForm,onSubmit:this.handleTeamNameSubmit},r.a.createElement("label",null,"Add New Team",r.a.createElement("input",{type:"text",name:"teamName",value:this.state.teamName,onChange:this.handleTeamNameChange})),r.a.createElement("input",{type:"submit",value:"Submit"}))),r.a.createElement("div",{style:O.teamSelection},s.map((function(t,a){return r.a.createElement("div",{key:c[a]},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",{style:O.headerRow},r.a.createElement("th",{style:O.numberColumn},"Price"),r.a.createElement("th",{style:O.numberColumn},"Points"),r.a.createElement("th",{style:O.playerColumn},"Name"),r.a.createElement("th",null,c[a]),r.a.createElement("th",null))),r.a.createElement("tbody",{style:O.tableBody},t.map((function(t,a){return r.a.createElement("tr",{key:t.player_id,style:a%2===0?O.evenRow:O.oddRow},r.a.createElement("td",null,t.now_cost),r.a.createElement("td",null,t.total_points),r.a.createElement("th",null,t.web_name),r.a.createElement("td",null,t.upcoming_fixtures.map((function(e,a){return r.a.createElement(m,{weekArray:e,key:"".concat(t.web_name,"-").concat(a)})}))),r.a.createElement("td",{style:O.drop},r.a.createElement("button",{style:{background:"rgb(247, 166, 166)",height:"20px",width:"20px",borderRadius:"20px"},id:t.player_id,onClick:e.removePlayerFromUserTeam},"-")))})))))}))),l.map((function(t){return r.a.createElement("div",{key:"AllPlayers-"+t.player_id},r.a.createElement("button",{style:{background:"rgb(114, 235, 118)",height:"20px",width:"20px",borderRadius:"20px"},id:t.player_id,onClick:e.addPlayerToUserTeam},"+"),"   ".concat(t.web_name,"      Total Points: ").concat(t.total_points))}))))}}]),a}(n.Component),O={teamInfo:{display:"flex",justifyContent:"space-between",paddingBottom:0,marginBottom:0},newTeamForm:{float:"right"},teamSelection:{paddingTop:0,marginTop:0},teamButton:{background:"white",border:"none",cursor:"pointer",overflow:"hidden",outline:"none",marginLeft:"2px",height:"100%"},selectedTeam:{background:"silver",fontWeight:"bold"},tableBody:{textAlign:"center",verticalAlign:"center"},headerRow:{background:"silver",height:"30px"},evenRow:{background:"gainsboro"},oddRow:{background:"whitesmoke"},numberColumn:{width:"45px"},playerColumn:{width:"135px"},drop:{padding:"10px"}},C=a(71),N=a(70),I=function(e,t){return console.log("STARTING TO UPDATE TEAM INFO"),fetch(x).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(a){return j(a,e,t)})).catch((function(e){return console.log(e)}))},j=function(e,t,a){for(var n in console.log("STARTING TO HANDLE FIXTURES"),e){var r=(n=e[n]).finished;if(null!=n.event){var o=parseInt(n.event),l=n.team_h,s=n.team_a,i=o<a.upcoming_gameweek?"previous_opponents":"future_opponents";if(t[l][i][o].push(s),t[s][i][o].push(l),r){var c=n.team_h_score,u=n.team_a_score;t[l].gf+=c,t[l].ga+=u,t[s].gf+=u,t[s].ga+=c}}}return t},R=function(e){var t={};for(var a in e)t[(a=e[a]).id]={team_id:a.team,web_name:a.web_name,element_type:a.element_type,total_points:a.total_points,player_id:a.id,now_cost:G(a.now_cost)};return console.log(t),t};function G(e){var t=(e=e.toString()).length-1;return e.substring(0,t)+"."+e.substring(t,e.length)}var F=a(27),P=function(e){var t,a=Object(F.a)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(!0===n.is_next)return n.id}}catch(r){a.e(r)}finally{a.f()}return console.error("handleEvents has not found the current gameweek"),console.error("I have not error handled the first or last week of the season as I'm not sure how FPL sends the data"),1},B=function(e,t){var a={};for(var n in e){var r=e[n].id;a[r]={team_id:r,short_name:e[n].short_name,gf:0,ga:0,previous_opponents:{},future_opponents:{}};for(var o=1;o<t;++o)a[r].previous_opponents[o]=[];for(var l=t;l<39;++l)a[r].future_opponents[l]=[]}return a},M=1,J=2,L=function(e,t){console.log("STARTING CREATE DISPLAYS");var a=[],n=[];for(var r in e)a.push(e[r].gf),n.push(e[r].ga);a.sort((function(e,t){return e-t})),n.sort((function(e,t){return e-t}));var o=(a[9]+a[10])/2,l=(n[9]+n[10])/2,s=Math.max(o-a[0],a[19]-o),i=Math.max(l-n[0],n[19]-l);for(var c in t.defenders_display=[],t.attackers_display=[],e){c=e[c];var u={},m={};u.short_name=c.short_name,m.short_name=c.short_name;var p=[],d=[],h=function(t){var a=[],n=[];c.future_opponents[t].forEach((function(t){var r=e[t].gf,c=e[t].ga,u={value:r,color:U(r,o,s,J)},m={value:c,color:U(c,l,i,M)};a.push(u),n.push(m)})),p.push(a),d.push(n)};for(var g in c.future_opponents)h(g);u.upcoming_fixtures=p,m.upcoming_fixtures=d,u.goals={value:c.ga,color:U(c.ga,l,i,J)},m.goals={value:c.gf,color:U(c.gf,o,s,M)},t.defenders_display.push(u),t.attackers_display.push(m)}return localStorage.setItem("BACKEND_DATA",JSON.stringify(t)),t};function U(e,t,a,n){var r,o,l;if(Math.abs(t-e)<=.5)l=100,o=100,r=100;else if(e>t&&n===M||e<t&&n===J){var s=40/a;l=122,o=75,r=75-Math.abs(e-t)*s}else{var i=31/a;l=0,o=84,r=85-Math.abs(e-t)*i}return"hsl(".concat(l,", ").concat(o,"%, ").concat(r,"%)")}var H=function(){var e=localStorage.getItem("UPDATE_TIMES");null===e&&(e=void fetch(x).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){var t={},a=new Date;return e.forEach((function(e){if(null!==e.kickoff_time){var n=e.kickoff_time;n=n.split("T")[0]+"T21:00:00";var r=new Date(n);r>a&&(t[r]=null)}})),localStorage.setItem("UPDATE_TIMES",JSON.stringify(Object.keys(t).sort((function(e,t){return Date(e)<Date(t)})))),Object.keys(t).sort((function(e,t){return Date(e)<Date(t)}))})));var t=localStorage.getItem("BACKEND_DATA");if(null===t||function(e){var t=new Date;if(new Date(e[0])>t)return!1;for(var a=0;a<e.length;++a){if(new Date(e[a])>t){var n=e.slice(a,e.length);localStorage.setItem("UPDATE_TIMES",JSON.stringify(n));break}}return!0}(JSON.parse(e))){console.log("FETCHING BACKEND DATA");var a={};return fetch(S).then((function(e){if(console.log(e),!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){console.log(e);var t=P(e.events),n=B(e.teams,t);return a.players=R(e.elements),a.upcoming_gameweek=t,I(n,a)})).then((function(e){return L(e,a)})).catch((function(e){return console.log(e)}))}return new Promise((function(e,a){e(JSON.parse(t)),a(W)}))};var W=function(){var e={};return fetch(S).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(t){var a=P(t.events),n=B(t.teams,a);return e.players=R(t.elements),e.upcoming_gameweek=a,I(n,e)})).then((function(t){return L(t,e)})).catch((function(e){return console.log(e)}))};a(43);var z=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).selectView=function(e){e.preventDefault(),n.setState({view:e.target.title})},n.showDisplay=function(){return"Defenders"===n.state.view?r.a.createElement(d,{display:n.state.defendersDisplay,upcomingGameweek:n.state.upcomingGameweek,type:"DEFENDERS"}):"Attackers"===n.state.view?r.a.createElement(d,{display:n.state.attackersDisplay,upcomingGameweek:n.state.upcomingGameweek,type:"ATTACKERS"}):"Home"===n.state.view?r.a.createElement(w,{post:{title:"FPL Scheduling Tool",description:"This tool shows the goals for and against, rather than the opponent they are playing",image:"PL_Banner.jpg",imgText:"",linkText:""},refreshData:n.refresh}):"Team"===n.state.view?r.a.createElement(A,{players:n.state.players,defendersDisplay:n.state.defendersDisplay,attackersDisplay:n.state.attackersDisplay}):r.a.createElement("div",null,"Error")},n.renderDesktopScreen=function(){var e=[{title:"Home",onClick:n.selectView},{title:"Defenders",onClick:n.selectView},{title:"Attackers",onClick:n.selectView},{title:"Team",onClick:n.selectView}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,null),r.a.createElement(C.a,{maxWidth:"lg"},r.a.createElement(D,{title:"FPL Tool",sections:e}),n.showDisplay()))},n.state={defendersDisplay:[],attackersDisplay:[],players:{},upcomingGameweek:1,view:"Home"},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;H().then((function(t){console.log(t),e.setState({defendersDisplay:t.defenders_display,attackersDisplay:t.attackers_display,upcomingGameweek:t.upcoming_gameweek,players:t.players,userTeams:t.user_teams})}))}},{key:"render",value:function(){return this.renderDesktopScreen()}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(z,{displayUrl:"http://127.0.0.1:5000/mainDisplays"}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[33,1,2]]]);
//# sourceMappingURL=main.5b048d36.chunk.js.map