(this["webpackJsonpdads-spreadsheet"]=this["webpackJsonpdads-spreadsheet"]||[]).push([[0],{29:function(e,t,a){e.exports=a(40)},34:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(15),l=a.n(o),s=(a(34),a(8)),i=a(9),c=a(11),u=a(10),m=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.weekArray;return 1===e.length?r.a.createElement("td",{style:Object.assign({},{background:e[0].color},p.tableData)},e[0].value):0===e.length?r.a.createElement("td",{style:Object.assign({},p.darkgrey,p.tableData)}):r.a.createElement("td",{style:p.doubleGame},r.a.createElement("div",{style:Object.assign({},{background:e[0].color},p.doubleGameData)},e[0].value),r.a.createElement("div",{style:Object.assign({},{background:e[1].color},p.doubleGameData)},e[1].value))}}]),a}(n.Component),p={tableData:{height:"30px",width:"2.2vw",textAlign:"center",border:"1px solid black",fontSize:"1vw"},doubleGame:{border:"1px solid black",width:"2.2vw",height:"30px",padding:"0px"},doubleGameData:{height:"15px",margin:"0px",padding:"0px",fontSize:".75vw",display:"flex",alignItems:"center",justifyContent:"center"},darkgrey:{background:"darkgrey",color:"darkgrey"}},d=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).createTable=function(t){return Object.keys(t).map((function(a){return a=t[a],r.a.createElement("tr",{key:a.short_name},r.a.createElement("td",{style:Object.assign({},{background:a.goals.color},g.tableData)},a.goals.value),r.a.createElement("th",null,a.short_name),a.upcoming_fixtures.map((function(t,n){return r.a.createElement(m,{weekArray:t,key:"".concat(a.short_name,"-").concat(n,"-").concat(e.props.type)})})))}))},e.createHeaders=function(e,t){var a=[];"DEFENDERS"===e?a.push("GA"):a.push("GF"),a.push("Team");for(var n=t;n<39;++n)n<10?a.push("0"+n):a.push(n);var o=a.map((function(e){return r.a.createElement("th",{key:e,style:g.column},e)}));return r.a.createElement("tr",null,o)},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{style:g.background},r.a.createElement("table",null,r.a.createElement("tbody",null,this.createHeaders(this.props.type,this.props.upcomingGameweek),this.createTable(this.props.display))))}}]),a}(n.Component),g={background:{padding:"2vh 2vw",display:"flex",flexFlow:"column no-wrap",alignItems:"stretch",background:"lightgrey",overflowX:"auto"},column:{textAlign:"center"},tableData:{height:"4vh",width:"2.2vw",textAlign:"center",border:"1px solid black",fontSize:"1vw"}},h=a(21),f=a(58),y=a(60),v=a(62),b=a(61),E=a(66),k=Object(f.a)((function(e){return{home:{position:"relative",backgroundColor:e.palette.grey[800],color:e.palette.common.white,marginBottom:e.spacing(4),backgroundImage:"url(https://source.unsplash.com/random)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},overlay:{position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"rgba(0,0,0,.3)"},homeContent:Object(h.a)({position:"relative",padding:e.spacing(3)},e.breakpoints.up("md"),{padding:e.spacing(6),paddingRight:0})}}));function _(e){var t=k(),a=e.post,n=e.refreshData;return r.a.createElement(y.a,{className:t.home,style:{backgroundImage:"url(".concat(a.image,")")}},r.a.createElement("img",{style:{display:"none"},src:a.image,alt:a.imageText}),r.a.createElement("div",{className:t.overlay}),r.a.createElement(b.a,{container:!0},r.a.createElement(b.a,{item:!0,md:6},r.a.createElement("div",{className:t.homeContent},r.a.createElement(v.a,{component:"h1",variant:"h3",color:"inherit",gutterBottom:!0},a.title),r.a.createElement(v.a,{variant:"h5",color:"inherit",paragraph:!0},a.description),r.a.createElement(E.a,{variant:"subtitle1",href:"#"},a.linkText)),r.a.createElement("div",{className:t.homeContent},r.a.createElement("button",{onClick:n},"Refresh Data")))))}var w=a(63),T=Object(f.a)((function(e){return{toolbar:{borderBottom:"1px solid ".concat(e.palette.divider)},toolbarTitle:{flex:1},toolbarSecondary:{justifyContent:"space-between",overflowX:"auto"},toolbarLink:{padding:e.spacing(1),flexShrink:0}}}));function S(e){var t=T(),a=e.sections;return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{component:"nav",variant:"dense",className:t.toolbarSecondary},a.map((function(e){return r.a.createElement(E.a,{title:e.title,color:"inherit",noWrap:!0,key:e.title,variant:"body2",href:"#",className:t.toolbarLink,onClick:e.onClick},e.title)}))))}var x="https://pl-fantasy-tool-cors.herokuapp.com/https://fantasy.premierleague.com/api/bootstrap-static/",D="https://pl-fantasy-tool-cors.herokuapp.com/https://fantasy.premierleague.com/api/fixtures/",C=function(){var e=JSON.parse(localStorage.getItem("BACKEND_DATA")),t=e.players,a=e.defenders_display,n=e.attackers_display,r=function(){var e=localStorage.getItem("USER_TEAMS");return null===e?(localStorage.setItem("USER_TEAMS",JSON.stringify([])),[]):JSON.parse(e)}(),o=[];return r.forEach((function(e){var r=[[],[],[],[]];e.players.forEach((function(e){var o={};o.player_id=e,o.web_name=t[e].web_name;var l=t[e].team_id;o.team_id=l,o.total_points=t[e].total_points,o.now_cost=t[e].now_cost;var s=t[e].element_type;o.upcoming_fixtures=s<=2?a[l-1].upcoming_fixtures:n[l-1].upcoming_fixtures,r[s-1].push(o)})),o.push({name:e.name,players:r})})),o},O=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).addPlayerToUserTeam=function(e){e.preventDefault();var t=e.target.id,a=document.getElementById("addPlayer"+t),r=a.style.getPropertyValue("background-color");if(function(e,t){var a=localStorage.getItem("USER_TEAMS");return-1===(a=JSON.parse(a))[t].players.indexOf(e)}(t,n.state.currentTeamIndex)){a.style.setProperty("background-color",A.green.background),setTimeout((function(){a.style.setProperty("background-color",r)}),400);var o=function(e,t){var a=localStorage.getItem("USER_TEAMS");return(a=JSON.parse(a))[t].players.push(e),localStorage.setItem("USER_TEAMS",JSON.stringify(a)),C()}(t,n.state.currentTeamIndex);n.setState({userTeams:o})}else a.style.setProperty("background-color",A.headerRow.background),setTimeout((function(){a.style.setProperty("background-color",r)}),400)},n.removePlayerFromUserTeam=function(e){e.preventDefault();var t=function(e,t){var a=localStorage.getItem("USER_TEAMS"),n=(a=JSON.parse(a))[t],r=n.players.indexOf(e);return-1!==r&&n.players.splice(r,1),a[t]=n,localStorage.setItem("USER_TEAMS",JSON.stringify(a)),C()}(e.target.id,n.state.currentTeamIndex);n.setState({userTeams:t})},n.handleTeamNameChange=function(e){n.setState({teamName:e.target.value})},n.handleTeamNameSubmit=function(e){e.preventDefault();var t=function(e){var t=localStorage.getItem("USER_TEAMS");return(t=JSON.parse(t)).push({name:e,players:[]}),localStorage.setItem("USER_TEAMS",JSON.stringify(t)),C()}(n.state.teamName);n.setState({userTeams:t,teamName:""})},n.changeCurrentTeam=function(e){n.setState({currentTeamIndex:e})},n.state={userTeams:[],currentTeamIndex:0,teamName:""},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.setState({userTeams:C()})}},{key:"render",value:function(){var e=this,t=this.props,a=t.orderedPlayers,n=t.players,o=["GOALKEEPERS","DEFENDERS","MIDFIELDERS","FORWARDS"];return r.a.createElement("div",null,0===this.state.userTeams.length?r.a.createElement("div",null,"Create a team",r.a.createElement("form",{onSubmit:this.handleTeamNameSubmit},r.a.createElement("label",null,"Team name:",r.a.createElement("input",{type:"text",name:"teamName",value:this.state.teamName,onChange:this.handleTeamNameChange})),r.a.createElement("input",{type:"submit",value:"Submit"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:A.teamInfo},r.a.createElement("div",null,"Teams:",this.state.userTeams.map((function(t,a){return a===e.state.currentTeamIndex?r.a.createElement("button",{key:"navbar-"+t.name,style:Object.assign({},A.teamButton,A.selectedTeam),onClick:function(){return e.changeCurrentTeam(a)}},t.name):r.a.createElement("button",{key:"navbar-"+t.name,style:A.teamButton,onClick:function(){return e.changeCurrentTeam(a)}},t.name)}))),r.a.createElement("form",{style:A.newTeamForm,onSubmit:this.handleTeamNameSubmit},r.a.createElement("label",null,"Add New Team",r.a.createElement("input",{type:"text",name:"teamName",value:this.state.teamName,onChange:this.handleTeamNameChange})),r.a.createElement("input",{type:"submit",value:"Submit"}))),r.a.createElement("div",{style:A.teamSelection},this.state.userTeams[this.state.currentTeamIndex].players.map((function(t,a){return r.a.createElement("div",{key:"Current Team"+o[a]},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",{style:A.headerRow},r.a.createElement("th",{style:A.numberColumn},"Price"),r.a.createElement("th",{style:A.numberColumn},"Points"),r.a.createElement("th",{style:A.playerColumn},"Name"),r.a.createElement("th",{style:A.fixturesColumn},o[a]),r.a.createElement("th",{style:A.numberColumn}))),r.a.createElement("tbody",{style:A.tableBody},t.map((function(t,a){return r.a.createElement("tr",{key:t.player_id,style:a%2===0?A.evenRow:A.oddRow},r.a.createElement("td",null,t.now_cost),r.a.createElement("td",null,t.total_points),r.a.createElement("th",null,t.web_name),r.a.createElement("td",null,r.a.createElement("div",null,r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,t.upcoming_fixtures.map((function(e,a){return r.a.createElement(m,{weekArray:e,key:"".concat(t.web_name,"-").concat(a)})}))))))),r.a.createElement("td",{style:A.buttonPadding},r.a.createElement("button",{style:Object.assign({},A.circleButton,A.red),id:t.player_id,onClick:e.removePlayerFromUserTeam},"-")))})))))}))),r.a.createElement("div",{style:A.playerSelectionArea},a.map((function(t,a){return r.a.createElement("div",{key:"playerList"+a},r.a.createElement("div",{style:A.playerHeader},o[a]),r.a.createElement("table",{style:A.tableBody},r.a.createElement("thead",{style:A.headerRow},r.a.createElement("tr",null,r.a.createElement("th",{style:A.playerColumn},"Name"),r.a.createElement("th",{style:A.numberColumn},"Points"),r.a.createElement("th",{style:A.numberColumn},"Cost"),r.a.createElement("th",{style:A.numberColumn}))),r.a.createElement("tbody",null,t.map((function(t,a){return r.a.createElement("tr",{key:"addPlayer"+t,id:"addPlayer"+t,style:a%2===0?A.evenRow:A.oddRow},r.a.createElement("td",{style:A.alignLeft},n[t].web_name),r.a.createElement("td",null,n[t].total_points),r.a.createElement("td",null,n[t].now_cost),r.a.createElement("td",{style:A.buttonPadding},r.a.createElement("button",{style:Object.assign({},A.circleButton,A.green),id:t,onClick:e.addPlayerToUserTeam},"+")))})))))})))))}}]),a}(n.Component),A={teamInfo:{display:"flex",justifyContent:"space-between",paddingBottom:0,marginBottom:0},newTeamForm:{float:"right"},teamSelection:{paddingTop:0,marginTop:0},teamButton:{background:"white",border:"none",cursor:"pointer",overflow:"hidden",outline:"none",marginLeft:"2px",height:"100%"},selectedTeam:{background:"silver",fontWeight:"bold"},tableBody:{textAlign:"center",verticalAlign:"center"},headerRow:{background:"silver",height:"30px"},evenRow:{background:"gainsboro"},oddRow:{background:"whitesmoke"},numberColumn:{width:"45px"},playerColumn:{width:"130px"},fixturesColumn:{width:"65%"},buttonPadding:{padding:"10px"},circleButton:{height:"20px",width:"20px",borderRadius:"20px",cursor:"pointer"},red:{background:"rgb(247, 166, 166)"},green:{background:"rgb(114, 235, 118)"},playerHeader:{textAlign:"center",background:"silver",height:"40px",paddingTop:"10px",fontWeight:"bold"},playerSelectionArea:{marginTop:"50px",display:"flex",justifyContent:"space-between"},alignLeft:{textAlign:"left",paddingLeft:"5px"}},N=a(65),I=a(64),j=function(e,t){return console.log("STARTING TO UPDATE TEAM INFO"),fetch(D).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(a){return R(a,e,t)})).catch((function(e){return console.log(e)}))},R=function(e,t,a){for(var n in console.log("STARTING TO HANDLE FIXTURES"),e){var r=(n=e[n]).finished;if(null!=n.event){var o=parseInt(n.event),l=n.team_h,s=n.team_a,i=o<a.upcoming_gameweek?"previous_opponents":"future_opponents";if(t[l][i][o].push(s),t[s][i][o].push(l),r){var c=n.team_h_score,u=n.team_a_score;t[l].gf+=c,t[l].ga+=u,t[s].gf+=u,t[s].ga+=c}}}return t},P=function(e){var t=[[],[],[],[]],a={};for(var n in e)a[(n=e[n]).id]={team_id:n.team,web_name:n.web_name,element_type:n.element_type,total_points:n.total_points,player_id:n.id,now_cost:B(n.now_cost)},t[n.element_type-1].push({player_id:n.id,total_points:n.total_points});for(var r=0;r<t.length;++r)t[r].sort((function(e,t){return t.total_points-e.total_points})),t[r]=t[r].map((function(e){return e.player_id}));return{playerDict:a,playerList:t}};function B(e){var t=(e=e.toString()).length-1;return e.substring(0,t)+"."+e.substring(t,e.length)}var M=a(23),F=function(e){var t,a=Object(M.a)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(!0===n.is_next)return n.id}}catch(r){a.e(r)}finally{a.f()}return console.error("handleEvents has not found the current gameweek"),console.error("I have not error handled the first or last week of the season as I'm not sure how FPL sends the data"),1},U=function(e,t){var a={};for(var n in e){var r=e[n].id;a[r]={team_id:r,short_name:e[n].short_name,gf:0,ga:0,previous_opponents:{},future_opponents:{}};for(var o=1;o<t;++o)a[r].previous_opponents[o]=[];for(var l=t;l<39;++l)a[r].future_opponents[l]=[]}return a},G=1,J=2,L=function(e,t){var a=[],n=[];for(var r in e)a.push(e[r].gf),n.push(e[r].ga);a.sort((function(e,t){return e-t})),n.sort((function(e,t){return e-t}));var o=(a[9]+a[10])/2,l=(n[9]+n[10])/2,s=Math.max(o-a[0],a[19]-o),i=Math.max(l-n[0],n[19]-l);for(var c in t.defenders_display=[],t.attackers_display=[],e){c=e[c];var u={},m={};u.short_name=c.short_name,m.short_name=c.short_name;var p=[],d=[],g=function(t){var a=[],n=[];c.future_opponents[t].forEach((function(t){var r=e[t].gf,c=e[t].ga,u={value:r,color:H(r,o,s,J)},m={value:c,color:H(c,l,i,G)};a.push(u),n.push(m)})),p.push(a),d.push(n)};for(var h in c.future_opponents)g(h);u.upcoming_fixtures=p,m.upcoming_fixtures=d,u.goals={value:c.ga,color:H(c.ga,l,i,J)},m.goals={value:c.gf,color:H(c.gf,o,s,G)},t.defenders_display.push(u),t.attackers_display.push(m)}return localStorage.setItem("BACKEND_DATA",JSON.stringify(t)),t.user_teams=C(),t};function H(e,t,a,n){var r,o,l;if(Math.abs(t-e)<=.5)l=100,o=100,r=100;else if(e>t&&n===G||e<t&&n===J){var s=40/a;l=122,o=75,r=75-Math.abs(e-t)*s}else{var i=31/a;l=0,o=84,r=85-Math.abs(e-t)*i}return"hsl(".concat(l,", ").concat(o,"%, ").concat(r,"%)")}var W=function(){var e=localStorage.getItem("UPDATE_TIMES");null===e&&(e=void fetch(D).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){var t={},a=new Date;return e.forEach((function(e){if(null!==e.kickoff_time){var n=e.kickoff_time;n=n.split("T")[0]+"T21:00:00";var r=new Date(n);r>a&&(t[r]=null)}})),localStorage.setItem("UPDATE_TIMES",JSON.stringify(Object.keys(t).sort((function(e,t){return Date(e)<Date(t)})))),Object.keys(t).sort((function(e,t){return Date(e)<Date(t)}))})));var t=localStorage.getItem("BACKEND_DATA");if(null===t||function(e){var t=new Date;if(new Date(e[0])>t)return!1;for(var a=0;a<e.length;++a){if(new Date(e[a])>t){var n=e.slice(a,e.length);localStorage.setItem("UPDATE_TIMES",JSON.stringify(n));break}}return!0}(JSON.parse(e))){console.log("FETCHING BACKEND DATA");var a={};return fetch(x).then((function(e){if(console.log(e),!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){var t=F(e.events),n=U(e.teams,t),r=P(e.elements);return a.ordered_players=r.playerList,a.players=r.playerDict,a.upcoming_gameweek=t,j(n,a)})).then((function(e){return L(e,a)})).catch((function(e){return console.log(e)}))}return new Promise((function(e,a){var n=JSON.parse(t);n.user_teams=C(),e(n),a(K)}))};var K=function(){var e={};return fetch(x).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(t){var a=F(t.events),n=U(t.teams,a),r=P(t.elements);return e.ordered_players=r.playerList,e.players=r.playerDict,e.upcoming_gameweek=a,j(n,e)})).then((function(t){return L(t,e)})).catch((function(e){return console.log(e)}))};a(39);var V=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).selectView=function(e){e.preventDefault(),n.setState({view:e.target.title})},n.showDisplay=function(){return n.state.loading?r.a.createElement("div",null,"Loading"):"Defenders"===n.state.view?r.a.createElement(d,{display:n.state.defendersDisplay,upcomingGameweek:n.state.upcomingGameweek,type:"DEFENDERS"}):"Attackers"===n.state.view?r.a.createElement(d,{display:n.state.attackersDisplay,upcomingGameweek:n.state.upcomingGameweek,type:"ATTACKERS"}):"Home"===n.state.view?r.a.createElement(_,{post:{title:"FPL Scheduling Tool",description:"This tool shows the goals for and against, rather than the opponent they are playing",imgText:"",linkText:""},refreshData:n.refresh}):"Team"===n.state.view?r.a.createElement(O,{orderedPlayers:n.state.orderedPlayers,players:n.state.players}):r.a.createElement("div",null,"Error")},n.renderDesktopScreen=function(){var e=[{title:"Home",onClick:n.selectView},{title:"Defenders",onClick:n.selectView},{title:"Attackers",onClick:n.selectView},{title:"Team",onClick:n.selectView}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,null),r.a.createElement(N.a,{maxWidth:"lg"},r.a.createElement(S,{title:"FPL Tool",sections:e}),n.showDisplay()))},n.state={defendersDisplay:[],attackersDisplay:[],players:{},orderedPlayers:[],upcomingGameweek:1,view:"Home",loading:!0},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;W().then((function(t){console.log(t),e.setState({defendersDisplay:t.defenders_display,attackersDisplay:t.attackers_display,upcomingGameweek:t.upcoming_gameweek,players:t.players,orderedPlayers:t.ordered_players,userTeams:t.user_teams,loading:!1})}))}},{key:"render",value:function(){return this.renderDesktopScreen()}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(V,{displayUrl:"http://127.0.0.1:5000/mainDisplays"}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[29,1,2]]]);
//# sourceMappingURL=main.78edda64.chunk.js.map